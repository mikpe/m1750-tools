<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.50
     from ld.texinfo on 20 November 1996 -->

<TITLE>Using LD, the GNU linker - Option Commands</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="ld_1.html">first</A>, <A HREF="ld_23.html">previous</A>, <A HREF="ld_25.html">next</A>, <A HREF="ld_33.html">last</A> section, <A HREF="ld_toc.html">table of contents</A>.
<P><HR><P>


<H2><A NAME="SEC24" HREF="ld_toc.html#TOC24">Option Commands</A></H2>
<P>
The command language includes a number of other commands that you can
use for specialized purposes.  They are similar in purpose to
command-line options.

</P>
<DL COMPACT>

<DT><CODE>CONSTRUCTORS</CODE>
<DD>
<A NAME="IDX308"></A>
 <A NAME="IDX309"></A>
 <A NAME="IDX310"></A>
 
When linking using the <CODE>a.out</CODE> object file format, the linker uses
an unusual set construct to support C++ global constructors and
destructors.  When linking object file formats which do not support
arbitrary sections, such as <CODE>ECOFF</CODE> and <CODE>XCOFF</CODE>, the linker
will automatically recognize C++ global constructors and destructors by
name.  For these object file formats, the <CODE>CONSTRUCTORS</CODE> command
tells the linker where this information should be placed.  The
<CODE>CONSTRUCTORS</CODE> command is ignored for other object file formats.

The symbol <CODE>__CTOR_LIST__</CODE> marks the start of the global
constructors, and the symbol <CODE>__DTOR_LIST</CODE> marks the end.  The
first word in the list is the number of entries, followed by the address
of each constructor or destructor, followed by a zero word.  The
compiler must arrange to actually run the code.  For these object file
formats GNU C++ calls constructors from a subroutine <CODE>__main</CODE>;
a call to <CODE>__main</CODE> is automatically inserted into the startup code
for <CODE>main</CODE>.  GNU C++ runs destructors either by using
<CODE>atexit</CODE>, or directly from the function <CODE>exit</CODE>.

For object file formats such as <CODE>COFF</CODE> or <CODE>ELF</CODE> which support
multiple sections, GNU C++ will normally arrange to put the
addresses of global constructors and destructors into the <CODE>.ctors</CODE>
and <CODE>.dtors</CODE> sections.  Placing the following sequence into your
linker script will build the sort of table which the GNU C++
runtime code expects to see.


<PRE>
      __CTOR_LIST__ = .;
      LONG((__CTOR_END__ - __CTOR_LIST__) / 4 - 2)
      *(.ctors)
      LONG(0)
      __CTOR_END__ = .;
      __DTOR_LIST__ = .;
      LONG((__DTOR_END__ - __DTOR_LIST__) / 4 - 2)
      *(.dtors)
      LONG(0)
      __DTOR_END__ = .;
</PRE>

Normally the compiler and linker will handle these issues automatically,
and you will not need to concern yourself with them.  However, you may
need to consider this if you are using C++ and writing your own linker
scripts.

<A NAME="IDX311"></A>
<A NAME="IDX312"></A>
<DT><CODE>FLOAT</CODE>
<DD>
<DT><CODE>NOFLOAT</CODE>
<DD>
These keywords were used in some older linkers to request a particular
math subroutine library.  <CODE>ld</CODE> doesn't use the keywords, assuming
instead that any necessary subroutines are in libraries specified using
the general mechanisms for linking to archives; but to permit the use of
scripts that were written for the older linkers, the keywords
<CODE>FLOAT</CODE> and <CODE>NOFLOAT</CODE> are accepted and ignored.

<A NAME="IDX313"></A>
<A NAME="IDX314"></A>
<DT><CODE>FORCE_COMMON_ALLOCATION</CODE>
<DD>
This command has the same effect as the <SAMP>`-d'</SAMP> command-line option:
to make <CODE>ld</CODE> assign space to common symbols even if a relocatable
output file is specified (<SAMP>`-r'</SAMP>).

<A NAME="IDX315"></A>
<A NAME="IDX316"></A>
<DT><CODE>INPUT ( <VAR>file</VAR>, <VAR>file</VAR>, ... )</CODE>
<DD>
<DT><CODE>INPUT ( <VAR>file</VAR> <VAR>file</VAR> ... )</CODE>
<DD>
Use this command to include binary input files in the link, without
including them in a particular section definition.  
Specify the full name for each <VAR>file</VAR>, including <SAMP>`.a'</SAMP> if
required.

<CODE>ld</CODE> searches for each <VAR>file</VAR> through the archive-library
search path, just as for files you specify on the command line.
See the description of <SAMP>`-L'</SAMP> in section <A HREF="ld_3.html#SEC3">Command Line Options</A>.

If you use <SAMP>`-l<VAR>file</VAR>'</SAMP>, <CODE>ld</CODE> will transform the name to
<CODE>lib<VAR>file</VAR>.a</CODE> as with the command line argument <SAMP>`-l'</SAMP>.

<A NAME="IDX317"></A>
<A NAME="IDX318"></A>
<DT><CODE>GROUP ( <VAR>file</VAR>, <VAR>file</VAR>, ... )</CODE>
<DD>
<DT><CODE>GROUP ( <VAR>file</VAR> <VAR>file</VAR> ... )</CODE>
<DD>
This command is like <CODE>INPUT</CODE>, except that the named files should
all be archives, and they are searched repeatedly until no new undefined
references are created.  See the description of <SAMP>`-('</SAMP> in
section <A HREF="ld_3.html#SEC3">Command Line Options</A>.

<A NAME="IDX319"></A>
<A NAME="IDX320"></A>
<DT><CODE>OUTPUT ( <VAR>filename</VAR> )</CODE>
<DD>
Use this command to name the link output file <VAR>filename</VAR>.  The
effect of <CODE>OUTPUT(<VAR>filename</VAR>)</CODE> is identical to the effect of
<SAMP>`-o <VAR>filename</VAR>'</SAMP>, which overrides it.  You can use this
command to supply a default output-file name other than <CODE>a.out</CODE>.

<A NAME="IDX321"></A>
<A NAME="IDX322"></A>
<DT><CODE>OUTPUT_ARCH ( <VAR>bfdname</VAR> )</CODE>
<DD>
Specify a particular output machine architecture, with one of the names
used by the BFD back-end routines (see section <A HREF="ld_28.html#SEC28">BFD</A>).  This command is often
unnecessary; the architecture is most often set implicitly by either the
system BFD configuration or as a side effect of the <CODE>OUTPUT_FORMAT</CODE>
command.

<A NAME="IDX323"></A>
<A NAME="IDX324"></A>
<DT><CODE>OUTPUT_FORMAT ( <VAR>bfdname</VAR> )</CODE>
<DD>
When <CODE>ld</CODE> is configured to support multiple object code formats,
you can use this command to specify a particular output format.
<VAR>bfdname</VAR> is one of the names used by the BFD back-end routines
(see section <A HREF="ld_28.html#SEC28">BFD</A>).  The effect is identical to the effect of the
<SAMP>`-oformat'</SAMP> command-line option.  This selection affects only
the output file; the related command <CODE>TARGET</CODE> affects primarily
input files.

<A NAME="IDX325"></A>
<A NAME="IDX326"></A>
<A NAME="IDX327"></A>
<DT><CODE>SEARCH_DIR ( <VAR>path</VAR> )</CODE>
<DD>
Add <VAR>path</VAR> to the list of paths where <CODE>ld</CODE> looks for
archive libraries.  <CODE>SEARCH_DIR(<VAR>path</VAR>)</CODE> has the same
effect as <SAMP>`-L<VAR>path</VAR>'</SAMP> on the command line.

<A NAME="IDX328"></A>
<A NAME="IDX329"></A>
<DT><CODE>STARTUP ( <VAR>filename</VAR> )</CODE>
<DD>
Ensure that <VAR>filename</VAR> is the first input file used in the link
process. 

<A NAME="IDX330"></A>
<A NAME="IDX331"></A>
<DT><CODE>TARGET ( <VAR>format</VAR> )</CODE>
<DD>
When <CODE>ld</CODE> is configured to support multiple object code formats,
you can use this command to change the input-file object code format
(like the command-line option <SAMP>`-b'</SAMP> or its synonym <SAMP>`-format'</SAMP>).
The argument <VAR>format</VAR> is one of the strings used by BFD to name
binary formats.  If <CODE>TARGET</CODE> is specified but <CODE>OUTPUT_FORMAT</CODE>
is not, the last <CODE>TARGET</CODE> argument is also used as the default
format for the <CODE>ld</CODE> output file.  See section <A HREF="ld_28.html#SEC28">BFD</A>.

<A NAME="IDX332"></A>
If you don't use the <CODE>TARGET</CODE> command, <CODE>ld</CODE> uses the value of
the environment variable <CODE>GNUTARGET</CODE>, if available, to select the
output file format.  If that variable is also absent, <CODE>ld</CODE> uses
the default format configured for your machine in the BFD libraries.
</DL>

<P><HR><P>
Go to the <A HREF="ld_1.html">first</A>, <A HREF="ld_23.html">previous</A>, <A HREF="ld_25.html">next</A>, <A HREF="ld_33.html">last</A> section, <A HREF="ld_toc.html">table of contents</A>.
</BODY>
</HTML>
