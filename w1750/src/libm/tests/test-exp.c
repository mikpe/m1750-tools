/*
 * Test for ANSI Standard C: 7.5.4.1
 * 
 * #include <math.h>
 * double exp (double x);
 * 
 * Copyright (c) 1997, Chris Nettleton Software
 *
 * This test program was developed for European Space Agency contract 
 * 11935/96/NL/JG. Permission to use copy, modify, and distribute this 
 * software for any purpose without fee is hereby granted, provided that 
 * this entire notice is included in all copies of any software which is 
 * or includes a copy or modification of this software and in all copies 
 * of the supporting documentation for such software. This software is 
 * provided "as is", without any express or implied warranty. In 
 * particular, neither the author nor the European Space Agency makes 
 * any representation or warranty of any kind concerning the 
 * merchantability of this software or its fitness for any particular 
 * purpose. 
 *
 * $Log: test-exp.c,v $
 * Revision 1.1  1997/05/07 09:29:36  nettleto
 * Initial revision
 *
 */

#include <math.h>

#include <report.h>
#include <float.h>


static struct test {
  double x;
  double y;
} tests [] = {
  -88.9, 2.461617432470000e-39,
  -87.8, 7.395107454600000e-39,
  -86.7, 2.221613055855000e-38,
  -85.6, 6.674094460757000e-38,
  -84.5, 2.005008781961600e-37,
  -83.4, 6.023379260483400e-37,
  -82.3, 1.809523132368780e-36,
  -81.2, 5.436107913807440e-36,
  -80.1, 1.633097069716663e-35,
  -79.0, 4.906094730649280e-35,
  -77.9, 1.473872310007919e-34,
  -76.8, 4.427757117361236e-34,
  -75.7, 1.330171749426362e-33,
  -74.6, 3.996056775640066e-33,
  -73.5, 1.200481799513882e-32,
  -72.4, 3.606446634465678e-32,
  -71.3, 1.083436444643775e-31,
  -70.2, 3.254822956104150e-31,
  -69.1, 9.778028538688981e-31,
  -68.0, 2.937482111710802e-30,
  -66.9, 8.824683955952014e-30,
  -65.8, 2.651081571253624e-29,
  -64.7, 7.964289183070663e-29,
  -63.6, 2.392604696866498e-28,
  -62.5, 7.187781739060988e-28,
  -61.4, 2.159328968802962e-27,
  -60.3, 6.486982722601148e-27,
  -59.2, 1.948797309316589e-26,
  -58.1, 5.854510664207127e-26,
  -57.0, 1.758792202424311e-25,
  -55.9, 5.283703777705034e-25,
  -54.8, 1.587312336957888e-24,
  -53.7, 4.768549792079899e-24,
  -52.6, 1.432551526886326e-23,
  -51.5, 4.303622624624486e-23,
  -50.4, 1.292879686878405e-22,
  -49.3, 3.884025228370609e-22,
  -48.2, 1.166825662722177e-21,
  -47.1, 3.505338011818744e-21,
  -46.0, 1.053061735755381e-20,
  -44.9, 3.163572287674373e-20,
  -43.8, 9.503896380929842e-20,
  -42.7, 2.855128260269690e-19,
  -41.6, 8.577279313511491e-19,
  -40.5, 2.576757109154980e-18,
  -39.4, 7.741006159285824e-18,
  -38.3, 2.325526769488654e-17,
  -37.2, 6.986268508675724e-17,
  -36.1, 2.098791048793052e-16,
  -35.0, 6.305116760146989e-16,
  -33.9, 1.894161754784879e-15,
  -32.8, 5.690376387583490e-15,
  -31.7, 1.709483540704536e-14,
  -30.6, 5.135572371480217e-14,
  -29.5, 1.542811203191887e-13,
  -28.4, 4.634860997992986e-13,
  -27.3, 1.392389193588498e-12,
  -26.2, 4.182968307488740e-12,
  -25.1, 1.256633126860238e-11,
  -24.0, 3.775134544279097e-11,
  -22.9, 1.134113093374976e-10,
  -21.8, 3.407064022429893e-10,
  -20.7, 1.023538597759415e-9,
  -19.6, 3.074879879586610e-9,
  -18.5, 9.237449661970594e-9,
  -17.4, 2.775083242240752e-8,
  -16.3, 8.336810789962777e-8,
  -15.2, 2.504516372327619e-7,
  -14.1, 7.523982992164210e-7,
  -13.0, 2.260329406981054e-6,
  -11.9, 6.790404807379473e-6,
  -10.8, 2.039950341117193e-5,
   -9.7, 6.128349505322209e-5,
   -8.6, 1.841057936675791e-4,
   -7.5, 5.530843701478335e-4,
   -6.4, 1.661557273173934e-3,
   -5.3, 4.991593906910216e-3,
   -4.2, 1.499557682047770e-2,
   -3.1, 4.504920239355780e-2,
   -2.0, 1.353352832366126e-1,
   -0.9, 4.065696597405991e-1,
    0.2, 1.221402758160169e0,
    1.3, 3.669296667619244e0,
    2.4, 1.102317638064160e1,
    3.5, 3.311545195869231e1,
    4.6, 9.948431564193380e1,
    5.7, 2.988674009670602e2,
    6.8, 8.978472916504176e2,
    7.9, 2.697282328268508e3,
    9.0, 8.103083927575384e3,
   10.1, 2.434300942440838e4,
   11.2, 7.313044183341549e4,
   12.3, 2.196959886721377e5,
   13.4, 6.600032247661566e5,
   14.5, 1.982759263537568e6,
   15.6, 5.956538013184615e6,
   16.7, 1.789442911955461e7,
   17.8, 5.375783597888365e7,
   18.9, 1.614974643686474e8,
   20.0, 4.851651954097902e8,
   21.1, 1.457516796051423e9,
   22.2, 4.378622438028950e9,
   23.3, 1.315410876001606e10,
   24.4, 3.951712661213642e10,
   25.5, 1.187160091321696e11,
   26.6, 3.566426011333785e11,
   27.7, 1.071413585016775e12,
   28.8, 3.218704289702040e12,
   29.9, 9.669522068253505e12,
   31.0, 2.904884966524742e13,
   32.1, 8.726756719906403e13,
   33.2, 2.621662603718903e14,
   34.3, 7.875909720343271e14,
   35.4, 2.366054038952471e15,
   36.5, 7.108019154642244e15,
   37.6, 2.135366964193667e16,
   38.7, 6.414996882488256e16,
   39.8, 1.927171567809350e17,
   40.9, 5.789543346328431e17,
   42.0, 1.739274941520501e18,
   43.1, 5.225070685617308e18,
   44.2, 1.569697982645001e19,
   45.3, 4.715633347319370e19,
   46.4, 1.416654548340564e20,
   47.5, 4.255865461793903e20,
   48.6, 1.278532642280834e21,
   49.7, 3.840924324446540e21,
   50.8, 1.153877435605170e22,
   51.9, 3.466439387843490e22,
   53.0, 1.041375943302908e23,
   54.1, 3.128466227025765e23,
   55.2, 9.398431946294693e23,
   56.3, 2.823444993143126e24,
   57.4, 8.482097518882250e24,
   58.5, 2.548162917802639e25,
   59.6, 7.655104461142897e25,
   60.7, 2.299720473192626e26,
   61.8, 6.908742110139301e26,
   62.9, 2.075500831548847e27,
   64.0, 6.235149080811616e27,
   65.1, 1.873142302281509e28,
   66.2, 5.627230462530909e28,
   67.3, 1.690513456445172e29,
   68.4, 5.078583088876836e29,
   69.5, 1.525690676539272e30,
   70.6, 4.583428093511128e30,
   71.7, 1.376937895172770e31,
   72.8, 4.136550041762353e31,
   73.9, 1.242688309181666e32,
   75.0, 3.733241996799001e32,
   76.1, 1.121527876595349e33,
   77.2, 3.369255941776538e33,
   78.3, 1.012180422626471e34,
   79.4, 3.040758035758188e34,
   80.5, 9.134941978066841e34,
   81.6, 2.744288232123042e35,
   82.7, 8.244297466860067e35,
   83.8, 2.476723834124866e36,
   84.9, 7.440489593176263e36,
   86.0, 2.235246603734715e37,
   87.1, 6.715051902081487e37,
};


int
main ()
{
  int len;
  int i;

  test ("test-exp", "test for the exp function");

  len = sizeof (tests) / sizeof (struct test);

  for (i = 0; i < len; i++)
    {
      double x = tests [i].x;
      double y = exp (x);
      double err = y / tests [i].y - 1;

      if (fabs (err) >= 100 * DBL_EPSILON) 
        failed ("x = %.11e, exp(x) = %.11e, err = %.11e",
                 x, y, err);
    }

  result ();
}


