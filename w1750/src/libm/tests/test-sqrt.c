/*
 * Test for ANSI Standard C: 7.5.5.2
 * 
 * #include <math.h>
 * double sqrt (double x);
 * 
 * Copyright (c) 1997, Chris Nettleton Software
 *
 * This test program was developed for European Space Agency contract 
 * 11935/96/NL/JG. Permission to use copy, modify, and distribute this 
 * software for any purpose without fee is hereby granted, provided that 
 * this entire notice is included in all copies of any software which is 
 * or includes a copy or modification of this software and in all copies 
 * of the supporting documentation for such software. This software is 
 * provided "as is", without any express or implied warranty. In 
 * particular, neither the author nor the European Space Agency makes 
 * any representation or warranty of any kind concerning the 
 * merchantability of this software or its fitness for any particular 
 * purpose. 
 *
 * $Log: test-sqrt.c,v $
 * Revision 1.1  1997/05/07 09:29:41  nettleto
 * Initial revision
 *
 */

#include <math.h>

#include <report.h>

static struct test {
  double x;
  double y;
} tests [] = {
1.0, 1.0,
10.0, 3.16227766016837933199,
100.0, 10.00000000000000000000,
1000.0, 31.62277660168379331998,
10000.0, 100.00000000000000000000,
100000.0, 316.22776601683793319988,
1000000.0, 1000.00000000000000000000,
10000000.0, 3162.27766016837933199889,
100000000.0, 10000.00000000000000000000,
1000000000.0, 31622.77660168379331998893,
10000000000.0, 100000.00000000000000000000,
100000000000.0, 316227.76601683793319988935,
1000000000000.0, 1000000.00000000000000000000,
10000000000000.0, 3162277.66016837933199889354,
100000000000000.0, 10000000.00000000000000000000,
1000000000000000.0, 31622776.60168379331998893544,
10000000000000000.0, 100000000.00000000000000000000,
100000000000000000.0, 316227766.01683793319988935444,
1000000000000000000.0, 1000000000.00000000000000000000,
10000000000000000000.0, 3162277660.16837933199889354443,
100000000000000000000.0, 10000000000.00000000000000000000,
1000000000000000000000.0, 31622776601.68379331998893544432,
10000000000000000000000.0, 100000000000.00000000000000000000,
100000000000000000000000.0, 316227766016.83793319988935444327,
1000000000000000000000000.0, 1000000000000.00000000000000000000,
10000000000000000000000000.0, 3162277660168.37933199889354443271,
100000000000000000000000000.0, 10000000000000.00000000000000000000,
1000000000000000000000000000.0, 31622776601683.79331998893544432718,
10000000000000000000000000000.0, 100000000000000.00000000000000000000,
100000000000000000000000000000.0, 316227766016837.93319988935444327185,
1000000000000000000000000000000.0, 1000000000000000.00000000000000000000,
10000000000000000000000000000000.0, 3162277660168379.33199889354443271853,
100000000000000000000000000000000.0, 10000000000000000.00000000000000000000,
1000000000000000000000000000000000.0, 31622776601683793.31998893544432718533,
10000000000000000000000000000000000.0, 100000000000000000.00000000000000000000,
100000000000000000000000000000000000.0, 316227766016837933.19988935444327185337,
1000000000000000000000000000000000000.0, 1000000000000000000.00000000000000000000,
10000000000000000000000000000000000000.0, 3162277660168379331.99889354443271853371,
100000000000000000000000000000000000000.0, 10000000000000000000.00000000000000000000,

0.1000000000000000000000000000000000000000, 0.3162277660168379331998893544432718533719,
0.0100000000000000000000000000000000000000, 0.1000000000000000000000000000000000000000,
0.0010000000000000000000000000000000000000, 0.0316227766016837933199889354443271853371,
0.0001000000000000000000000000000000000000, 0.0100000000000000000000000000000000000000,
0.0000100000000000000000000000000000000000, 0.0031622776601683793319988935444327185337,
0.0000010000000000000000000000000000000000, 0.0010000000000000000000000000000000000000,
0.0000001000000000000000000000000000000000, 0.0003162277660168379331998893544432718533,
0.0000000100000000000000000000000000000000, 0.0001000000000000000000000000000000000000,
0.0000000010000000000000000000000000000000, 0.0000316227766016837933199889354443271853,
0.0000000001000000000000000000000000000000, 0.0000100000000000000000000000000000000000,
0.0000000000100000000000000000000000000000, 0.0000031622776601683793319988935444327185,
0.0000000000010000000000000000000000000000, 0.0000010000000000000000000000000000000000,
0.0000000000001000000000000000000000000000, 0.0000003162277660168379331998893544432718,
0.0000000000000100000000000000000000000000, 0.0000001000000000000000000000000000000000,
0.0000000000000010000000000000000000000000, 0.0000000316227766016837933199889354443271,
0.0000000000000001000000000000000000000000, 0.0000000100000000000000000000000000000000,
0.0000000000000000100000000000000000000000, 0.0000000031622776601683793319988935444327,
0.0000000000000000010000000000000000000000, 0.0000000010000000000000000000000000000000,
0.0000000000000000001000000000000000000000, 0.0000000003162277660168379331998893544432,
0.0000000000000000000100000000000000000000, 0.0000000001000000000000000000000000000000,
0.0000000000000000000010000000000000000000, 0.0000000000316227766016837933199889354443,
0.0000000000000000000001000000000000000000, 0.0000000000100000000000000000000000000000,
0.0000000000000000000000100000000000000000, 0.0000000000031622776601683793319988935444,
0.0000000000000000000000010000000000000000, 0.0000000000010000000000000000000000000000,
0.0000000000000000000000001000000000000000, 0.0000000000003162277660168379331998893544,
0.0000000000000000000000000100000000000000, 0.0000000000001000000000000000000000000000,
0.0000000000000000000000000010000000000000, 0.0000000000000316227766016837933199889354,
0.0000000000000000000000000001000000000000, 0.0000000000000100000000000000000000000000,
0.0000000000000000000000000000100000000000, 0.0000000000000031622776601683793319988935,
0.0000000000000000000000000000010000000000, 0.0000000000000010000000000000000000000000,
0.0000000000000000000000000000001000000000, 0.0000000000000003162277660168379331998893,
0.0000000000000000000000000000000100000000, 0.0000000000000001000000000000000000000000,
0.0000000000000000000000000000000010000000, 0.0000000000000000316227766016837933199889,
0.0000000000000000000000000000000001000000, 0.0000000000000000100000000000000000000000,
0.0000000000000000000000000000000000100000, 0.0000000000000000031622776601683793319988,
0.0000000000000000000000000000000000010000, 0.0000000000000000010000000000000000000000,
0.0000000000000000000000000000000000001000, 0.0000000000000000003162277660168379331998,
0.0000000000000000000000000000000000000100, 0.0000000000000000001000000000000000000000,

.0001, .01000000000000000000,
.00017, .01303840481040529742,
.000289, .01700000000000000000,
.0004913, .02216528817768900562,
.00083521, .02890000000000000000,
.001419857, .03768098990207130957,
.0024137569, .04913000000000000000,
.00410338673, .06405768283352122626,
.006975757441, .08352100000000000000,
.0118587876497, .10889806081698608465,
.02015993900449, .14198570000000000000,
.034271896307633, .18512670338887634391,
.0582622237229761, .24137569000000000000,
.09904578032905937, .31471539576108978466,
.168377826559400929, .41033867300000000000,
.2862423051509815793, .53501617279385263392,
.48661191875666868481, .69757574410000000000,
.82724026188633676417, .90952749374954947766,
1.40630844520677249908, 1.18587876496999999999,
2.39072435685151324843, 1.54619673937423411203,
4.06423140664757252233, 2.01599390044899999998,
6.90919339130087328796, 2.62853445693619799045,
11.74562876521148458953, 3.42718963076329999996,
19.96756890085952380220, 4.46850857679153658376,
33.94486713146119046374, 5.82622237229760999994,
57.70627412348402378835, 7.59646458054561219240,
98.10066600992284044019, 9.90457803290593699991,
166.77113221686882874832, 12.91398978692754072708,
283.51092476867700887214, 16.83778265594009289984,
481.96857210675091508263, 21.95378263777681923605,
819.34657258147655564047, 28.62423051509815792973,
1392.88917338851014458879, 37.32143048422059270128,
2367.91159476046724580094, 48.66119187566686848055,
4025.44971109279431786159, 63.44643182317500759218,
6843.26450885775034036470, 82.72402618863367641694
};


int
main ()
{
  int len;
  int i;

  test ("test-sqrt", "test for the sqrt function");

  len = sizeof (tests) / sizeof (struct test);

  for (i = 0; i < len; i++)
    {
      double x = tests [i].x;
      double y = sqrt (x);
      double err = y / tests [i].y - 1;

      if (fabs (err) >= DBL_EPSILON)
        failed ("x = %.10e, sqrt (x) = %.10e, err = %e",
                 x, y, err);
    }

  result ();
}


