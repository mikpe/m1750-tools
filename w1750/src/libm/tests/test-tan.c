/*
 * Test for ANSI Standard C: 7.5.2.7
 * 
 * #include <math.h>
 * double tan (double x);
 * 
 * Copyright (c) 1997, Chris Nettleton Software
 *
 * This test program was developed for European Space Agency contract 
 * 11935/96/NL/JG. Permission to use copy, modify, and distribute this 
 * software for any purpose without fee is hereby granted, provided that 
 * this entire notice is included in all copies of any software which is 
 * or includes a copy or modification of this software and in all copies 
 * of the supporting documentation for such software. This software is 
 * provided "as is", without any express or implied warranty. In 
 * particular, neither the author nor the European Space Agency makes 
 * any representation or warranty of any kind concerning the 
 * merchantability of this software or its fitness for any particular 
 * purpose. 
 *
 * $Log: test-tan.c,v $
 * Revision 1.3  1997/08/05 11:53:46  nettleto
 * Reduced test range to +/- pi/4 and tightened error margin
 * to 2 epsilons.
 *
 * Revision 1.2  1997/07/16 21:20:43  nettleto
 * Increased error limit to 1000 * DBL_EPSILON.
 *
 */

#include <math.h>

#include <report.h>
#include <float.h>


static struct test {
  double x;
  double y;
} tests [] = {
  -.78539816337500000000, -.99999999995510338077,
  -.76303748360000210304, -.95624963630827433430,
  -.74067680382500420608, -.91433137806942757934,
  -.71831612405000630912, -.87409309614530313710,
  -.69595544427500841216, -.83539785209637925879,
  -.67359476450001051520, -.79812198973781715752,
  -.65123408472501261824, -.76215350421644743057,
  -.62887340495001472128, -.72739064238965885565,
  -.60651272517501682432, -.69374069689262516422,
  -.58415204540001892736, -.66111896309430299828,
  -.56179136562502103040, -.62944783359706678220,
  -.53943068585002313344, -.59865600932442291330,
  -.51707000607502523648, -.56867780979187668319,
  -.49470932630002733952, -.53945256804197647513,
  -.47234864652502944256, -.51092409808106721579,
  -.44998796675003154560, -.48304022458789829492,
  -.42762728697503364864, -.45575236625578008073,
  -.40526660720003575168, -.42901516544580727063,
  -.38290592742503785472, -.40278615792056523086,
  -.36054524765003995776, -.37702547733696549129,
  -.33818456787504206080, -.35169558993642941541,
  -.31582388810004416384, -.32676105550707934603,
  -.29346320832504626688, -.30218831122730291014,
  -.27110252855004836992, -.27794547545035707397,
  -.24874184877505047296, -.25400216886965527029,
  -.22638116900005257600, -.23032935082551233306,
  -.20402048922505467904, -.20689916878579150664,
  -.18165980945005678208, -.18368481926279374867,
  -.15929912967505888512, -.16066041862316219691,
  -.13693844990006098816, -.13780088241172823416,
  -.11457777012506309120, -.11508181194835887473,
  -.09221709035006519424, -.09247938707247165467,
  -.06985641057506729728, -.06997026400581857051,
  -.04749573080006940032, -.04753147738272458272,
  -.02513505102507150336, -.02514034556006309309,
  -.00277437125007360640, -.00277437836833297702,
  .01958630852492429056, .01958881349860124202,
  .04194698829992218752, .04197160823340877266,
  .06430766807492008448, .06439646257051484389,
  .08666834784991798144, .08688600211094281206,
  .10902902762491587840, .10946311309088836893,
  .13138970739991377536, .13215103638937563769,
  .15375038717491167232, .15497346460348332543,
  .17611106694990956928, .17795464306542089253,
  .19847174672490746624, .20111947573523056966,
  .22083242649990536320, .22449363697747420717,
  .24319310627490326016, .24810369032169611111,
  .26555378604990115712, .27197721541693410814,
  .28791446582489905408, .29614294452279521353,
  .31027514559989695104, .32063091003694384825,
  .33263582537489484800, .34547260474532490104,
  .35499650514989274496, .37070115670199865769,
  .37735718492489064192, .39635152090610926593,
  .39971786469988853888, .42246069025156253577,
  .42207854447488643584, .44906792858938152584,
  .44443922424988433280, .47621502917435572863,
  .46679990402488222976, .50394660227988306239,
  .48916058379988012672, .53231039637427690615,
  .51152126357487802368, .56135765797857334616,
  .53388194334987592064, .59114353619516559872,
  .55624262312487381760, .62172753893966763167,
  .57860330289987171456, .65317404916428834958,
  .60096398267486961152, .68555291087861547878,
  .62332466244986750848, .71894009661471709756,
  .64568534222486540544, .75341847022592681298,
  .66804602199986330240, .78907866165192434523,
  .69040670177486119936, .82602007365385983341,
  .71276738154985909632, .86435204468584665454,
  .73512806132485699328, .90419519723486053842,
  .75748874109985489024, .94568300740566015791,
  .77984942087485278720, .98896363961226697925,
};


int
main ()
{
  int len;
  int i;
  double ms = 0.0;

  test ("test-tan", "test for the tan function");

  len = sizeof (tests) / sizeof (struct test);

  for (i = 0; i < len; i++)
    {
      double x = tests [i].x;
      double y = tan (x);
      double err = y - tests [i].y;

      ms += err * err;
      if (fabs (err) >=  2 * DBL_EPSILON) 
        failed ("x = %.10e, tan (x) = %.10e, err = %e",
                 x, y, err);
    }

  comment ("rms error = %.3e", sqrt (ms / len));

  result ();
}


