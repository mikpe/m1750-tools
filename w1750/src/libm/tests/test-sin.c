/*
 * Test for ANSI Standard C: 7.5.2.6
 * 
 * #include <math.h>
 * double sin (double x);
 * 
 * Copyright (c) 1997, Chris Nettleton Software
 *
 * This test program was developed for European Space Agency contract 
 * 11935/96/NL/JG. Permission to use copy, modify, and distribute this 
 * software for any purpose without fee is hereby granted, provided that 
 * this entire notice is included in all copies of any software which is 
 * or includes a copy or modification of this software and in all copies 
 * of the supporting documentation for such software. This software is 
 * provided "as is", without any express or implied warranty. In 
 * particular, neither the author nor the European Space Agency makes 
 * any representation or warranty of any kind concerning the 
 * merchantability of this software or its fitness for any particular 
 * purpose. 
 *
 * $Log: test-sin.c,v $
 * Revision 1.2  1997/08/04 11:01:16  nettleto
 * Reduced error margin to +/- 2 epsilons
 *
 * Revision 1.1  1997/05/07 09:29:41  nettleto
 * Initial revision
 *
 */

#include <math.h>

#include <report.h>
#include <float.h>

static struct test {
  double x;
  double y;
} tests [] = {
  -6.28318530717958647688, .00000000000000000004,
  -6.18318530717958647688, .09983341664682815235,
  -6.08318530717958647688, .19866933079506121550,
  -5.98318530717958647688, .29552020666133957514,
  -5.88318530717958647688, .38941834230865049170,
  -5.78318530717958647688, .47942553860420300031,
  -5.68318530717958647688, .56464247339503535723,
  -5.58318530717958647688, .64421768723769105370,
  -5.48318530717958647688, .71735609089952276165,
  -5.38318530717958647688, .78332690962748338848,
  -5.28318530717958647688, .84147098480789650667,
  -5.18318530717958647688, .89120736006143533997,
  -5.08318530717958647688, .93203908596722634968,
  -4.98318530717958647688, .96355818541719296471,
  -4.88318530717958647688, .98544972998846018066,
  -4.78318530717958647688, .99749498660405443094,
  -4.68318530717958647688, .99957360304150516434,
  -4.58318530717958647688, .99166481045246861534,
  -4.48318530717958647688, .97384763087819518652,
  -4.38318530717958647688, .94630008768741448847,
  -4.28318530717958647688, .90929742682568169537,
  -4.18318530717958647688, .86320936664887377065,
  -4.08318530717958647688, .80849640381959018427,
  -3.98318530717958647688, .74570521217672017735,
  -3.88318530717958647688, .67546318055115092653,
  -3.78318530717958647688, .59847214410395649401,
  -3.68318530717958647688, .51550137182146423521,
  -3.58318530717958647688, .42737988023382993451,
  -3.48318530717958647688, .33498815015590491950,
  -3.38318530717958647688, .23924932921398232814,
  -3.28318530717958647688, .14112000805986722205,
  -3.18318530717958647688, .04158066243329057914,
  -3.08318530717958647688, -.05837414342757990918,
  -2.98318530717958647688, -.15774569414324838205,
  -2.88318530717958647688, -.25554110202683131929,
  -2.78318530717958647688, -.35078322768961984816,
  -2.68318530717958647688, -.44252044329485238430,
  -2.58318530717958647688, -.52983614090849321324,
  -2.48318530717958647688, -.61185789094271907576,
  -2.38318530717958647688, -.68776615918397381812,
  -2.28318530717958647688, -.75680249530792825140,
  -2.18318530717958647688, -.81827711106441050429,
  -2.08318530717958647688, -.87157577241358806004,
  -1.98318530717958647688, -.91616593674945498404,
  -1.88318530717958647688, -.95160207388951595404,
  -1.78318530717958647688, -.97753011766509705539,
  -1.68318530717958647688, -.99369100363346445614,
  -1.58318530717958647688, -.99992325756410088418,
  -1.48318530717958647688, -.99616460883584067177,
  -1.38318530717958647688, -.98245261262433251226,
  -1.28318530717958647688, -.95892427466313846888,
  -1.18318530717958647688, -.92581468232773229692,
  -1.08318530717958647688, -.88345465572015326465,
  -.98318530717958647688, -.83226744222390116353,
  -.88318530717958647688, -.77276448755598736232,
  -.78318530717958647688, -.70554032557039190619,
  -.68318530717958647688, -.63126663787232131142,
  -.58318530717958647688, -.55068554259763776118,
  -.48318530717958647688, -.46460217941375721137,
  -.38318530717958647688, -.37387666483023635977,
  -.28318530717958647688, -.27941549819892587276,
  -.18318530717958647688, -.18216250427209553997,
  -.08318530717958647688, -.08308940281749657795,
  .0,                    .0,
  .01681469282041352312, .01681390048434989035,
  .11681469282041352312, .11654920485049328952,
  .21681469282041352312, .21511998808781552434,
  .31681469282041352312, .31154136351337817439,
  .41681469282041352312, .40484992061659816167,
  .51681469282041352312, .49411335113860832226,
  .61681469282041352312, .57843976438819987021,
  .71681469282041352312, .65698659871878909043,
  .81681469282041352312, .72896904012587615210,
  .91681469282041352312, .79366786384915305249,
  1.01681469282041352312, .85043662062856451754,
  1.11681469282041352312, .89870809581162675928,
  1.21681469282041352312, .93799997677473885796,
  1.31681469282041352312, .96791967203148642591,
  1.41681469282041352312, .98816823387700036855,
  1.51681469282041352312, .99854334537460496344,
  1.61681469282041352312, .99894134183977203630,
  1.71681469282041352312, .98935824662338177780,
  1.81681469282041352312, .96988981084508624321,
  1.91681469282041352312, .94073055667977290113,
  2.01681469282041352312, .90217183375629363998,
  2.11681469282041352312, .85459890808828066280,
  2.21681469282041352312, .79848711262349028663,
  2.31681469282041352312, .73439709787411314368,
  2.41681469282041352312, .66296923008218279216,
  2.51681469282041352312, .58491719289176225349,
  2.61681469282041352312, .50102085645788498197,
  2.71681469282041352312, .41211848524175656971,
  2.81681469282041352312, .31909836234935177075,
  2.91681469282041352312, .22288991410024695748,
  3.01681469282041352312, .12445442350706240794,
  3.11681469282041352312, .02477542545335812103,
  3.21681469282041352312, -.07515112046180930732,
  3.31681469282041352312, -.17432678122297998516,
  3.41681469282041352312, -.27176062641094312438,
  3.51681469282041352312, -.36647912925192774821,
  3.61681469282041352312, -.45753589377532104445,
  3.71681469282041352312, -.54402111088936981344,
  3.81681469282041352312, -.62507064889288236500,
  3.91681469282041352312, -.69987468759354286266,
  4.01681469282041352312, -.76768580976358197829,
  4.11681469282041352312, -.82782646908565347553,
  4.21681469282041352312, -.87969575997167009804,
  4.31681469282041352312, -.92277542161280675877,
  4.41681469282041352312, -.95663501627018807364,
  4.51681469282041352312, -.98093623006649140500,
  4.61681469282041352312, -.99543625330637736988,
  4.71681469282041352312, -.99999020655070345705,
  4.81681469282041352312, -.99455258820398916353,
  4.91681469282041352312, -.97917772915131720812,
  5.01681469282041352312, -.95401924990208918768,
  5.11681469282041352312, -.91932852566467582541,
  5.21681469282041352312, -.87545217468842852693,
  5.31681469282041352312, -.82282859496870862088,
  5.41681469282041352312, -.76198358391903281893,
  5.51681469282041352312, -.69352508477712287367,
  5.61681469282041352312, -.61813711223703357912,
  5.71681469282041352312, -.53657291800043497162,
  5.81681469282041352312, -.44964746453460115122,
  5.91681469282041352312, -.35822928223682805414,
  6.01681469282041352312, -.26323179136580165055,
  6.11681469282041352312, -.16560417544830974850,
  6.21681469282041352312, -.06632189735120068888,
  6.31681469282041352312, .03362304722113704948,
};


int
main ()
{
  int len;
  int i;
  double ms = 0.0;

  test ("test-sin", "test for the sin function");

  len = sizeof (tests) / sizeof (struct test);

  for (i = 0; i < len; i++)
    {
      double x = tests [i].x;
      double y = sin (x);
      double err = y - tests [i].y;

      ms += err * err;
      if (abs (err) >= 2.0 * DBL_EPSILON)
        failed ("x = %.10e, err = %+e, y = %.12e", x, err, y);
    }

  comment ("rms error = %.3e", sqrt (ms / len));

  result ();
}


