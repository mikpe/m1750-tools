/*
 * Test for ANSI Standard C: 7.5.2.4
 * 
 * #include <math.h>
 * double atan2 (double y, double x);
 * 
 * Copyright (c) 1997, Chris Nettleton Software
 *
 * This test program was developed for European Space Agency contract 
 * 11935/96/NL/JG. Permission to use copy, modify, and distribute this 
 * software for any purpose without fee is hereby granted, provided that 
 * this entire notice is included in all copies of any software which is 
 * or includes a copy or modification of this software and in all copies 
 * of the supporting documentation for such software. This software is 
 * provided "as is", without any express or implied warranty. In 
 * particular, neither the author nor the European Space Agency makes 
 * any representation or warranty of any kind concerning the 
 * merchantability of this software or its fitness for any particular 
 * purpose. 
 *
 * $Log: test-atan2.c,v $
 * Revision 1.1  1997/05/07 09:29:35  nettleto
 * Initial revision
 *
 */

#include <math.h>

#include <report.h>
#include <float.h>


static struct test {
  double n, d;
  double y;
} tests [] = {
  -5.906655781251220e+02, -3.717409841955100e+02, -2.132524412380972e+00, 
  -7.209517575711732e+01, -6.394583004765076e+02, -3.029322609597799e+00, 
  5.002827035880757e+02, 4.434687259777313e+02, 8.455257481613779e-01, 
  6.194177174660664e+02, -6.730426374846799e+02, 2.397661278995370e+00, 
  -4.632468922632800e+02, 3.646287303696108e+02, -9.039614181577942e-01, 
  -1.107071000529243e+02, 2.545800983815565e+02, -4.101937424316877e-01, 
  2.848185801674243e+02, -9.200722426594243e+01, 1.883252641062974e+00, 
  6.199162221170851e+02, -6.316706694824345e+02, 2.365585849170909e+00, 
  -1.395086815925710e+02, -2.462510087318073e+02, -2.626146800379625e+00, 
  -9.604397667222839e+02, -6.292247671295215e+01, -1.636217071035380e+00, 
  5.242864726196403e+02, -6.067394191582976e+02, 2.428966779595832e+00, 
  3.842630025974738e+02, 8.568048424602317e+02, 4.215922513174998e-01, 
  -1.435979277798052e+02, 8.338022539554535e+01, -1.044725827543487e+00, 
  -4.402881472600440e+01, -2.497302395326764e+02, -2.967080561530111e+00, 
  6.462592561901110e+02, 5.322880994997341e+02, 8.818031635220333e-01, 
  7.224505719024990e+02, -6.282001266759382e+02, 2.286525916484895e+00, 
  7.132892347079653e+02, 6.464250430679643e+02, 8.345337603701761e-01, 
  6.964152833791406e+02, 2.685215811032280e+02, 1.202785235387669e+00, 
  -1.175759351227237e+02, 7.069147823747812e+02, -1.648139332187951e-01, 
  -7.101564230289688e+02, -6.674355180913425e+02, -2.325193134377967e+00, 
  1.357853685461947e+02, -8.498969165553483e+01, 2.130051193873972e+00, 
  7.483111373705085e+02, -3.765094066419366e+02, 2.036957195300189e+00, 
  -3.567833626625268e+02, 7.476024347521908e+02, -4.452717479785471e-01, 
  -8.233974382286533e+02, -6.683142838990594e+02, -2.252603416521738e+00, 
  -6.972930022852623e+02, 2.726122597958058e+01, -1.531720430164914e+00, 
  -2.303112588758296e+02, -4.620875867716778e+02, -2.679214066201040e+00, 
  -4.663339669125106e+02, 5.111322578604263e+02, -7.395991748966744e-01, 
  -4.582680779246164e+02, 8.766307627644259e+02, -4.816899010280626e-01, 
  -3.614945538260104e+02, 2.917646630848481e+01, -1.490260234115032e+00, 
  8.718305804782882e+02, 6.021980676443461e+02, 9.663201117215774e-01, 
  -2.959709367060364e+02, -7.636576695695396e+01, -1.823306793368009e+00, 
  4.130157139521447e+02, 3.125026062065182e+02, 9.230616137296631e-01, 
  -1.400377749510207e+02, -1.026109170718135e+02, -2.203157531823979e+00, 
  -7.145693655674465e+02, 1.845167353679344e+02, -1.318095449379968e+00, 
  -5.788241999232606e+02, -5.244863639340633e+02, -2.306984441217969e+00, 
  -3.875299428483210e+02, 3.737204267436623e+01, -1.474657093746590e+00, 
  -7.256204421013858e+02, 1.909464031039940e+02, -1.313480789510210e+00, 
  5.401803478904554e+02, -3.231792335631694e+02, 2.109950345519806e+00, 
  1.619516287926392e+02, 3.565783909309108e+02, 4.263265629393784e-01, 
  -8.910515877429193e+02, -2.570454054328702e+02, -1.851645752195349e+00, 
  -8.191228112805704e+02, 7.462750913221537e+02, -8.319008456955204e-01, 
  6.213924354649815e+02, -7.905568715365829e+02, 2.475435264040212e+00, 
  -3.528453569360934e+01, 1.619404487378191e+02, -2.145328835383601e-01, 
  3.255325401382907e+02, -8.317005630386705e+02, 2.768516833320830e+00, 
  -3.065678051429472e+02, 8.894998986483431e+02, -3.319024178980574e-01, 
  9.712348812769882e+02, 2.449579229814494e+02, 1.323736062771152e+00, 
  7.039677019193702e+01, -8.295964775766631e+02, 3.056938811784435e+00, 
  4.847563910692743e+02, -7.909349085567757e+02, 2.591748814093484e+00, 
  8.785121141711580e+02, 4.143650013939406e+02, 1.130071089935353e+00, 
};


int
main ()
{
  int len;
  int i;

  test ("test-atan2", "test for the atan2 function");

  len = sizeof (tests) / sizeof (struct test);

  for (i = 0; i < len; i++)
    {
      double n = tests [i].n;
      double d = tests [i].d;
      double y = atan2 (n, d);
      double err = y / tests [i].y - 1;

      if (fabs (err) >= 2 * DBL_EPSILON) 
        failed ("n = %.10e, d = %.10e, atan2 (n,d) = %.10e, err = %e",
                 n, d, y, err);
    }

  result ();
}


